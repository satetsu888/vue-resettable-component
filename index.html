<script language="javascript" src="http://cdnjs.cloudflare.com/ajax/libs/vue/0.12.10/vue.js"></script>

<div id="app">
    <color-component color="0000ff"/>
</div>


<script type="x-template" id="color-component">
    <div>
        <p style="background-color:{{getBase('color')}}">baseData:{{getBase('color')}}</p>
        <p style="background-color:{{color}}">currentData:{{color}}</p>
        <p><input type=text v-model="color"></p>
        changed: {{changed}} <br>
        <input type=button value="Reset" v-on="click: reset">
        <input type=button value="Set Current as Base"v-on="click: setAsBase()">
    </div>
</script>

<script>
var resettable = {
    data: function(){
        return { 
            base: {},
            current: {},
        }
    },
    created: function(){
        var initialData = JSON.parse(JSON.stringify(this._data));
        
        delete initialData["base"];
        delete initialData["current"];
        this.setAsBase(initialData);
    },
    computed: {
        changed: function(){
            return JSON.stringify(this.base) !== JSON.stringify(this.current) ? true : false;
        }
    },
    methods: {
        setAsBase: function(newBaseData){
            var self = this;
            var baseData = newBaseData ? newBaseData : self.current;

            Object.keys(baseData).forEach(function(key){
                self.$watch(key, function(newVal, oldVal){ self.current[key] = newVal },{ deep: true});
            });
            this.base = JSON.parse(JSON.stringify(baseData));

            self.reset();
        },
        getBase: function(paramName){
            return paramName ? this.base[paramName] : this.base;
        },
        reset: function(){
            var self = this;
            self.current = JSON.parse(JSON.stringify(self.base));
            Object.keys(self.base).forEach(function(key){
                self.$data[key] = self.base[key];
            });
        }
    },
    replase: true
};
</script>

<script>
    var colorComponent = Vue.extend({
        props: ["color"],
        template: "#color-component",
        mixins: [resettable]
    });

    var app = new Vue({
        el: '#app',
        components:{
            'color-component': colorComponent
        }
    })
</script>
